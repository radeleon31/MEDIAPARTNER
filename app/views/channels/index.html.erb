<body class="background-image">
  <div class="container" >
    <% if (@name_view) %>
      <h1><%= @name_view %></h1>
    <% end %>

  <div class="btn-group">
    <button type="button" class="btn btn-primary">Date Monetizer</button>
    <%# <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button> %>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="#">Last Day</a>
      <a class="dropdown-item" href="#">Last Week</a>
      <a class="dropdown-item" href="#">Last Month</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="#">Last Year</a>
    </div>
  </div>

  <div class="card-group mt-2">
    <div class="card">
      <div class="card-body border border-primary rounded  bg-dark text-white">
        <h5 class="card-title"><%= @avg_watch_sec_count %></h5>
        <p class="card-text">Avg Watch Sec</p>
        <%# <p class="card-text"><small class="text-muted badge badge-success">99.0%</small></p> %>
        <%= pie_chart Publishing.group(:title).sum(:avg_watch_sec), legend: false, width: "200px", height: "125px" %>
      </div>
    </div>
    <div class="card">
      <div class="card-body border border-primary rounded bg-dark text-white">
        <h5 class="card-title"><%= @percent_watch_count %></h5>
        <p class="card-text">Percent Watch Count</p>
        <%# <p class="card-text"><small class="text-muted badge badge-success">99.0%</small></p> %>
        <%= pie_chart Publishing.group(:title).sum(:percent_watch), legend: false, width: "200px", height: "125px" %>
      </div>
    </div>
    <div class="card">
      <div class="card-body border border-primary rounded bg-dark text-white">
        <h5 class="card-title"><%= @impressions_count %></h5>
        <p class="card-text">Impressions</p>
        <%# <p class="card-text"><small class="text-muted badge badge-success">88.8%</small></p> %>
        <%= pie_chart Publishing.group(:title).sum(:impressions), legend: false, width: "200px", height: "125px" %>
        
      </div>
    </div>
      <div class="card">
      <div class="card-body border border-primary rounded bg-dark text-white">
        <h5 class="card-title"><%= @comments_count %></h5>
        <p class="card-text">Comments</p>
        <%# <p class="card-text"><small class="text-muted badge badge-success">77%</small></p> %>
        <%= pie_chart Publishing.group(:title).sum(:comments), legend: false, width: "200px", height: "125px" %>
      </div>
    </div>
      <div class="card">
      <div class="card-body border border-primary rounded bg-dark text-white">
        <h5 class="card-title"><%= @revenue_count %></h5>
        <p class="card-text">Revenue</p>
        <%# <p class="card-text"><small class="text-muted badge badge-success">33.3%</small></p> %>
        <%= pie_chart Publishing.group(:title).sum(:comments), legend: false, width: "200px", height: "125px" %>
      </div>
    </div>  
  </div>

  <div class="row m-3" >
    <div class="col-sm-8">
      <div class="card">
        <div class="card-body">
          <h2 class="card-title mb-0">Channel Detail</h2>
          <p class="card-text badge badge-primary">Youtube Analytics Information</p>
      <div class="table-responsive-md mt-2 sortable  ">
      <table class="table table-striped table-dark sortabletitle ">
        <thead>
          <tr>
            <th scope="col">Channel Name</th>
            <th scope="col">Avg Watch Sec</th>
            <th scope="col">Percent Watch Count</th>
            <th scope="col">Impressions</th>
            <th scope="col">Comments</th>
            <th scope="col">Revenue</th>
          </tr>
        </thead>
        <tbody>
          <% @channels.each do |channel| %>
           <% tot_avg = 0 %>
           <% tot_watch = 0 %>
           <% tot_Impre = 0 %>
           <% tot_commen = 0 %>
           <% tot_revenue = 0 %>
           <% channel.publishings.each do |publishing| %>
            <% if (publishing.avg_watch_sec != nil) %>
             <% tot_avg += publishing.avg_watch_sec %>
            <% end %>
            <% if (publishing.percent_watch != nil) %>
             <% tot_watch += publishing.percent_watch %>
            <% end %>
            <% if (publishing.impressions != nil) %>
             <% tot_Impre += publishing.impressions %>
            <% end %>
            <% if (publishing.comments != nil) %>
             <% tot_commen += publishing.comments %>
            <% end %>
            <% if (publishing.revenue != nil) %>
             <% tot_revenue += publishing.revenue %>
            <% end %>
           <% end %>
          <tr>
            <td> <%= channel.name %> </td>
            <td><%= tot_avg %><br><p class="card-text"></p></td>
            <td><%= tot_watch %><br><p class="card-text"></p></td>
            <td><%= tot_Impre %><br><p class="card-text"></p></td>
            <td><%= tot_commen %><br><p class="card-text"></p></td>
            <td><%= tot_revenue %><br><p class="card-text"></p></td>
            
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
        </div>
      </div>
    </div>
    <div class="col-sm-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title font-weight-bold">Show by:</h5>
          <p class="card-text">see how yourn different types of posts are performing</p>

          <p class="card-text mb-0">Organic</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
          </div>
          <p class="card-text mb-0">Paid</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">60%</div>
          </div>

            <p class="card-text mb-0">Posted</p>
            <div class="progress" style="height: 10px;" >
              <div class="progress-bar progress-bar-striped"" role="progressbar" style="width: 43%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
            </div>

          <p class="card-text mb-0">Crossposted</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">60%</div>
          </div>

          <p class="card-text mb-0">Shared</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
          </div>
          <p class="card-text mb-0">Follower</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">60%</div>
          </div>

          <p class="card-text mb-0">Non Follower</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
          </div>
          <p class="card-text mb-0">Live</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">60%</div>
          </div>
          <p class="card-text mb-0">Video</p>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">60%</div>
          </div>


        </div>
      </div>
    </div>
  </div>
</div>